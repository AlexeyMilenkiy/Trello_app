<div [style.display]="isDownloaded ? 'block': 'none'"
     (click)="close($event)"
     class="modal__wrapper">

  <div class="modal__card">

    <div class="modal__card__header">
      <span class="modal__card__header__cardIcon"></span>

      <form [formGroup]="formTitle"
            (ngSubmit)="changeTitle()">

        <textarea class="modal__card__title"
                  maxlength="200"
                  #titleCard
                  formControlName="titleText"
                  autosize
                  [minRows]="3"
                  (keydown.enter)="$event.preventDefault(); $event.target.blur()"
                  (keydown.shift.enter)="$event.preventDefault()"
                  (blur)="blurOnTitle(titleCard)"></textarea>
      </form>

      <span (click)="close($event)"
         class="modal__card__close"></span>

    </div>

    <div class="modal__card__description">

      <div class="modal__card__description__container">
        <span class="modal__card__description-icon"></span>
        <span class="modal__card__description__headline">Description</span>
        <button *ngIf="card?.description && !isEditDescription"
                (click)="isEditDescription = true"
                class="modal__card__edit-btn">Edit</button>
      </div>

      <form *ngIf="isEditDescription"
            [formGroup]="formDescription"
            (ngSubmit)="changeDescription()">

        <textarea class="modal__card__description__text"
                  placeholder="Add a more detailed description..."
                  formControlName="descriptionText"
                  maxlength="400"
                  (blur)="changeDescription()"
                  appAutoFocusDirective></textarea>

        <div class="modal__card__description__btn-wrap">

          <button type="submit" class="modal__card__description-save">Save</button>
          <span (click)="changeDescription()"
                class="modal__card__description-close">
          </span>
        </div>

      </form>

      <p *ngIf="card?.description && !isEditDescription"
         (click)="isEditDescription = true"
        class="modal__card__description__content">
        {{card.description}}
      </p>

      <p *ngIf="!card?.description && !isEditDescription"
         (click)="isEditDescription = true"
        class="modal__card__description__preview">
        Add a more detailed description...
      </p>

    </div>

    <button *ngIf="(authorId === userId) || (authorId === undefined)"
            (click)="deleteCard()"
            class="modal__card__delete">
            Delete card
    </button>

  </div>

</div>
